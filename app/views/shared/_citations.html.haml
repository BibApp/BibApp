%div#citations{:class => "span-14 prepend-1"}
  - if @q
    %div{:class => "span-4"}
      %h3="Citations (#{@q.total_hits})"

    / Sort Form
    %div{:class => "span-8 append-1 last"}
      - form_tag "", :method => :get do
        #sort-by
          %label Sort by:
          %select{:name => "sort"}
            - ["year", "score"].each do |opt|
              - if opt == @sort
                %option{:selected => "selected", :value => "#{opt}"}= opt.titleize
              - else
                %option{:value => "#{opt}"}= opt.titleize
          
          %label Show:
          %select{:name => "rows"}
            - ["10", "20", "50", "100", "250", "500"].each do |opt|
              - if opt == @rows
                %option{:selected => "selected", :value => "#{opt}"}= opt.titleize
              - else
                %option{:value => "#{opt}"}= opt.titleize

          = hidden_field_tag "q", @query
          = hidden_field_tag "fq", @filter
          = hidden_field_tag "view", "all"
          - @page = 1 if @page == 0
          = hidden_field_tag "page", @page              

          = submit_tag 'Go'

    %div{:class => "span-12"}= will_paginate WillPaginate::Collection.new((params[:page]||1), @rows, @q.total_hits)

    %ol{:class => "span-12 citations", :style => "clear:both;"}
      - @docs.each do |citation, score|
        = render :partial => "shared/citation", :locals => {:citation => citation, :score => score}
        
    %div{:class => "span-12"}= will_paginate WillPaginate::Collection.new((params[:page]||1), @rows, @q.total_hits)